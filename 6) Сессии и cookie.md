
Сессии и cookie:
- как работает аутентификация на основе сессии и cookie
- настройка безопасных cookie

Куки нужны для подержания сессии пользователя, они генерируется при регистрации/входе пользователя в систему сервер генерирует SessionID и сохраняет его в БД и отдает ответом на запрос клиента, выглядит это примерно так.
```
Set-Cookie: token=123abc
```
Браузер сохраняет это значение в Cookie Storage и будет его добавлять ко всем последующим запросам для того, чтобы сервер понимал что мы продолжаем общение в констекте того, что человек уже залогинен/выбран какой то язык и тп информации о пользователе. 

Также возможно сохранение не сервере, а непосредственно в браузерных кукакх, в зашифрованном виде. Потом на сервере они дешифруются получается id пользователя.

Отличие, как я понял, в том, что на основе сессий храним ключ на сервере и гоняем его по кукам, а при основе на куках, у нас они шифруется и храниться *только в куках* и дешифруется на сервере.

**ВАЖНО!!!**
Для того, чтобы cookie передавались важно, чтобы сервер передавал такой заголовок
```
Access-Control-Allow-Credentials: true
```
Примерная конфигурация безопасных кук (много всяких настроек, которые можно сделать чтобы предотвратить атаки)

```javascript
// Пример безопасной конфигурации cookie в Express
app.use(session({
  secret: process.env.SESSION_SECRET, // Минимум 32 символа
  name: '__Secure-sessionId', // Префикс для безопасности
  cookie: {
    secure: true,           // Только HTTPS
    httpOnly: true,         // Защита от XSS
    sameSite: 'strict',     // Защита от CSRF
    maxAge: 24 * 60 * 60 * 1000, // 24 часа
    domain: 'ваш-домен.com', // Ограничение домена
    path: '/',              // Ограничение пути
  },
  resave: false,
  saveUninitialized: false,
  store: redisStore, // Хранение сессий в Redis, а не в памяти
}));
```

Чтобы было:

FETCH API:
```
credentials: 'include': Чтобы браузеры могли отправлять запрос с учётными данными (даже для cross-origin запросов)  
credentials: 'same-origin': если URL принадлежит одному источнику (origin) что и вызывающий его скрипт  
credentials: 'omit': учётные данные не передаются с запросом
```
